<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Member Card</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      background: #f5f5f5;
      font-family: sans-serif;
    }
    .card {
      position: relative;
      width: 300px;
    }
    .card img {
      width: 100%;
      display: block;
    }
    .field {
      position: absolute;
      left: 20px;
      color: #222;
      font-size: 16px;
      font-weight: bold;
    }
    .name { top: 58px; left: 120px; }
    .join { top: 88px; left: 120px; }
    .expire { top: 120px; left: 120px; }
  </style>
</head>
<body>

  <div class="card">
    <img src="card.png">
    <div class="field name" id="name"></div>
<div class="field join" id="join"></div>
<div class="field expire" id="expire"></div>
  </div>

</body>
<script>
  const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTH3k49gzRtNcKd8E32h5hz0rWkh3wKUkkPymfAh4NDtg0YZogVaCIV2YH8Ly68Gqhx7Fw6f4_UlGRj/pub?output=csv";

  const params = new URLSearchParams(window.location.search);
  const memberId = params.get("id");

  if (!memberId) {
    document.body.innerHTML = "<h2>ไม่พบรหัสสมาชิก</h2>";
  } else {
    fetch(csvUrl)
      .then(res => res.text())
      .then(text => {
        const rows = text.trim().split("\n").map(r => r.split(","));
        const headers = rows[0];
        const data = rows.slice(1);

        const idIndex = headers.indexOf("id");
        const nameIndex = headers.indexOf("name");
        const joinIndex = headers.indexOf("join_date");
        const expireIndex = headers.indexOf("expire_date");

        const member = data.find(r => r[idIndex] === memberId);

        if (!member) {
          document.body.innerHTML = "<h2>ไม่พบข้อมูลสมาชิก</h2>";
          return;
        }

        document.getElementById("name").innerText = member[nameIndex];
        document.getElementById("join").innerText = "สมัคร: " + member[joinIndex];
        document.getElementById("expire").innerText = "หมดอายุ: " + member[expireIndex];
      });
  }
</script>

</html>
